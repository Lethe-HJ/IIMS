(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc6536e6"],{7364:function(t,e,o){var r=o("ddf7").f,i=Function.prototype,s=/^\s*function ([^ (]*)/,a="name";a in i||o("dad2")&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"7a8b":function(t,e,o){"use strict";var r=o("93b7"),i=o.n(r);i.a},"93b7":function(t,e,o){},c8de:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("van-cell-group",[o("van-cell",{ref:t.projectAliasText,attrs:{title:"项目别名","is-link":"",value:t.displayWorkItemDetail.project_name},on:{click:function(e){return t.editProjectAlias("projectAliasText")}}}),o("van-cell",{ref:t.workAddressText,attrs:{title:"工作地址","is-link":"",value:t.displayWorkItemDetail.work_address},on:{click:function(e){return t.editWorkAddress("workAddressText")}}}),o("van-cell",{ref:t.workNatrueText,attrs:{title:"工作性质","is-link":"",value:t.displayWorkItemDetail.work_property},on:{click:function(e){return t.editWorkNature("workNatrueText")}}}),o("van-cell",{ref:t.workItemText,attrs:{title:"工作简介",value:t.displayWorkItemDetail.work_intro},on:{click:function(e){return t.editWorkItem("workItemText")}}}),o("van-cell",{ref:t.workRemarksText,attrs:{title:"备注",value:t.displayWorkItemDetail.remarks},on:{click:function(e){return t.editWorkRemarks("workRemarksText")}}}),o("van-button",{attrs:{type:"primary",size:"large"},on:{click:t.onSubmitChange}},[t._v("确认添加")]),o("van-button",{staticClass:"return-btn",attrs:{type:"primary",size:"large"},on:{click:t.goBack}},[t._v("返回")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showEditProject,expression:"showEditProject"}],staticClass:"edit-project"},["workItemText"==t.showEdit?o("div",{staticClass:"edit-info"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.displayWorkItemDetail.work_intro,expression:"displayWorkItemDetail.work_intro"}],staticClass:"daily-textarea",attrs:{rows:"20",placeholder:"请输入工作简介"},domProps:{value:t.displayWorkItemDetail.work_intro},on:{input:function(e){e.target.composing||t.$set(t.displayWorkItemDetail,"work_intro",e.target.value)}}})]):t._e(),"workRemarksText"==t.showEdit?o("div",{staticClass:"edit-info"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.displayWorkItemDetail.remarks,expression:"displayWorkItemDetail.remarks"}],staticClass:"daily-textarea",attrs:{rows:"20",placeholder:"请输入工作备注"},domProps:{value:t.displayWorkItemDetail.remarks},on:{input:function(e){e.target.composing||t.$set(t.displayWorkItemDetail,"remarks",e.target.value)}}})]):t._e(),o("div",{staticClass:"edit-btn"},[o("van-button",{attrs:{type:"primary"},on:{click:t.onEditSubmit}},[t._v("完成")]),o("van-button",{staticClass:"return-btn",attrs:{type:"primary"},on:{click:t.onEidtCancel}},[t._v("取消")])],1)]),o("van-popup",{attrs:{position:"bottom"},model:{value:t.isPopShow,callback:function(e){t.isPopShow=e},expression:"isPopShow"}},["projectAliasText"==t.showEdit?o("van-search",{attrs:{placeholder:"请输入搜索关键词",shape:"round"},model:{value:t.searchByProjectAliasText,callback:function(e){t.searchByProjectAliasText=e},expression:"searchByProjectAliasText"}}):t._e(),"projectAliasText"==t.showEdit?o("van-picker",{attrs:{"show-toolbar":"",columns:t.displayProjectAlias,title:"选择项目别名"},on:{cancel:t.onCancel,confirm:t.ConfirmProjectAlias}}):t._e(),"workAddressText"==t.showEdit?o("van-picker",{attrs:{"show-toolbar":"",columns:t.displayWorkAddress,title:"选择工作地址"},on:{cancel:t.onCancel,confirm:t.ConfirmWorkAddress}}):t._e(),"workNatrueText"==t.showEdit?o("van-picker",{attrs:{"show-toolbar":"",columns:t.displayWorkProperty,title:"选择工作性质"},on:{cancel:t.onCancel,confirm:t.ConfirmWorkProperty}}):t._e()],1)],1)},i=[],s=(o("7364"),{name:"EditWorkItem",components:{},data:function(){return{showEditProject:!1,showEdit:"",projectAliasText:"projectAliasText",workAddressText:"workAddressText",workNatrueText:"workNatrueText",workItemText:"workItemText",workRemarksText:"workRemarksText",isPopShow:!1,searchByProjectAliasText:"",searchProjectAlias:[],datePicker:"",displayProjectAlias:[],displayWorkAddress:["公司","出差现场"],displayWorkProperty:[],projectAliasId:[],workPropertyId:[],allProjectAlias:[],selectProjectAlias:"",changeValue:"",initWorkIntro:""}},computed:{displayWorkItemDetail:function(){return this.$store.state.displayWorkItemDetail},judgeAdd:function(){return this.$store.state.judgeAdd}},mounted:function(){var t=this,e=this.$route.query.projectName;this.$store.commit("storeDisplayWorkItemDetail",{project_name:e});var o=this.$route.query.introId;if(-1!==o){var r={intro_id:o};this.$api.get("/iims/intros/edit/data?",r).then(function(e){if(1===e.status){var o=e.data;o.work_address=parseInt(o.work_address),1===o.work_address?o.work_address="公司":2===o.work_address&&(o.work_address="出差现场"),console.log(12,o),t.$store.commit("storeDisplayWorkItemDetail",o)}},function(e){t.$myToast("数据加载失败","warning",1500)})}else this.$store.commit("storeDisplayWorkItemDetail",{});this.$api.get("/iims/common/projects/data?limit=20").then(function(e){if(1===e.status){console.log("项目别名数据",e);var o=[];e.data.projects.some(function(t,e){o.push(t)});for(var r=[],i=0;i<o.length;i++)r.push(o[i].name),t.projectAliasId.push(o[i].id);console.log("searchProjectAlias",t.searchProjectAlias),t.displayProjectAlias=r}}).catch(function(t){console.log(t)}),this.$api.get("/iims/common/property/data").then(function(e){if(1===e.status){console.log("工作性质数据",e);var o=e.data,r=[];console.log("temp1",r),o.property.some(function(t,e){r.push(t)});var i=[];r.some(function(e,o){i.push(e.name),t.workPropertyId.push(e.id)}),t.displayWorkProperty=i}}).catch(function(t){console.log(t)})},methods:{ConfirmProjectAlias:function(t,e){var o=this;this.displayWorkItemDetail.project_name=t,this.displayWorkItemDetail.project_id=this.projectAliasId[e],console.log("未搜索的id",e,this.displayWorkItemDetail.project_id),this.searchProjectAlias.some(function(e,r){if(e.name==t)return o.displayWorkItemDetail.project_id=e.id,!0}),console.log("搜索时的id",this.displayWorkItemDetail.project_id),this.isPopShow=!1},ConfirmWorkAddress:function(t){this.displayWorkItemDetail.work_address=t,this.isPopShow=!1},ConfirmWorkProperty:function(t,e){this.displayWorkItemDetail.work_property=t,this.displayWorkItemDetail.work_property_id=this.workPropertyId[e],console.log(this.displayWorkItemDetail.work_property_id),this.isPopShow=!1},onSubmitChange:function(){var t=this;if("公司"===this.displayWorkItemDetail.work_address?this.displayWorkItemDetail.work_address=1:"出差现场"===this.displayWorkItemDetail.work_address&&(this.displayWorkItemDetail.work_address=2),this.judgeAdd){var e=this.$route.query.enterItemFormDaily;if(e){var o=this.$route.query.projectId;this.displayWorkItemDetail.project_id=o}r={project_id:this.displayWorkItemDetail.project_id,work_address:this.displayWorkItemDetail.work_address,work_property_id:this.displayWorkItemDetail.work_property_id,work_intro:this.displayWorkItemDetail.work_intro,remarks:this.displayWorkItemDetail.remarks};this.$api.post("/iims/intros/add",r).then(function(o){1===o.status&&(t.$myToast("新增成功","success",1500),e?(console.log(e),t.$router.push({name:"add_work_daily",query:{enterItemFormDaily:!1}})):t.$router.push({name:"WorkItemManage"}))}).catch(function(e){t.$myToast("新增失败","error","1500")})}else{var r={intro_id:this.displayWorkItemDetail.intro_id,project_id:this.displayWorkItemDetail.project_id,work_address:this.displayWorkItemDetail.work_address,work_property_id:this.displayWorkItemDetail.work_property_id,work_intro:this.displayWorkItemDetail.work_intro,remarks:this.displayWorkItemDetail.remarks};this.$api.put("/iims/intros/edit?",r).then(function(e){1===e.status&&(t.$myToast("修改成功","success","1500"),t.$router.push({name:"WorkItemManage"}))},function(e){t.$myToast("修改失败","error","1500")})}},searchWorkPropertyIdByName:function(t){for(var e=0;e<this.workPropertyId.length;++e)if(this.displayWorkProperty[e]==t)return this.workPropertyId[e];return""},getSearchProjectAlias:function(t){var e=this,o={query:t};this.$api.get("/iims/common/projects/query?",o).then(function(t){if(1===t.status){var o=[];t.data.projects.some(function(t,e){o.push(t)}),e.searchProjectAlias=o;for(var r=[],i=0;i<t.data.projects.length;i++)r.push(t.data.projects[i].name);e.displayProjectAlias=r}}).catch(function(t){console.log(t)})},goBack:function(){this.$router.go(-1)},showPicker1:function(t){this.initWorkIntro&&this.showEditProject&&(this.displayWorkDailyDetail.work_intro=this.initWorkMatters),this.isPopShow=!0,this.showEditProject=!1,this.showEdit=t},hiddenPicker:function(){this.isPopShow=!1,this.datePicker=""},editProjectAlias:function(t){this.showPicker1(t)},editWorkAddress:function(t){this.showPicker1(t)},editWorkNature:function(t){this.showPicker1(t)},showPicker2:function(t){this.isPopShow=!1,this.showEditProject=!0,this.showEdit=t},editWorkItem:function(t){this.showPicker2(t),this.initWorkIntro=this.displayWorkItemDetail.work_intro},editWorkRemarks:function(t){this.showPicker2(t)},onEidtCancel:function(){this.isPopShow=!1,this.showEditProject=!1,this.showEdit="",this.displayWorkItemDetail.work_intro=this.initWorkIntro},onEditSubmit:function(){this.isPopShow=!1,this.showEditProject=!1,this.showEdit=""},onCancel:function(){this.isPopShow=!1}},watch:{searchByProjectAliasText:function(t){this.getSearchProjectAlias(t)}}}),a=s,n=(o("7a8b"),o("6691")),l=Object(n["a"])(a,r,i,!1,null,"15cd542a",null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-cc6536e6.d8b8bf3e.js.map